---
title: "Аналіз фідбеку High-Value користувачів"
subtitle: "Топ-5 проблем, баг-репорт та методологія — Operations Demand Team"
lang: uk
format:
  html:
    theme: flatly
    toc: true
    toc-depth: 3
    toc-title: "Зміст"
    number-sections: false
    smooth-scroll: true
    mainfont: "Segoe UI"
    fontsize: "1rem"
    linestretch: 1.6
    title-block-banner: "#1B3A5C"
    title-block-banner-color: white
    code-fold: true
    code-summary: "Показати код"
    df-print: kable
  typst:
    toc: true
    toc-depth: 3
    number-sections: false
    mainfont: "Arial"
    fontsize: 11pt
    margin:
      x: 25mm
      y: 25mm
    code-fold: true
knitr:
  opts_chunk:
    dev: ragg_png
    dpi: 300
---

```{r}
#| label: setup
#| include: false

library(tidyverse)
library(knitr)
library(ragg)

is_html <- knitr::is_html_output()
if (is_html) library(kableExtra)

# --- Завантаження готових результатів з Main.R ---
ideas <- read_delim("output/ideas.csv", delim = ";", show_col_types = FALSE)
top5  <- read_delim("output/top_5_ideas.csv", delim = ";", show_col_types = FALSE)
bugs  <- read_delim("output/bugs_report.csv", delim = ";", show_col_types = FALSE)

# Для підрахунку загальної статистики
categorised_feedback <- readxl::read_excel("data/Feedback_Classified.xlsx", sheet = 1) |>
  janitor::clean_names() |>
  mutate(user_id = as.numeric(user_id))
```

## Огляд {.unnumbered}

::: {.callout-note appearance="minimal"}
Цей звіт підсумовує аналіз зворотного зв'язку від **найбільш цінних (high-value) користувачів** платформи. Основна мета — виявити **топ-5 найболючіших проблем** за кількістю згадувань, а також задокументувати технічні баги.
:::

```{r}
#| label: overview-stats

n_feedbacks <- nrow(categorised_feedback)
n_users <- n_distinct(categorised_feedback$user_id)
n_ideas_total <- nrow(ideas)
n_bugs_total <- nrow(bugs)
total_bug_mentions <- sum(bugs$number_of_mentions)
```

| Метрика | Значення |
|---------|:--------:|
| Фідбеків оброблено | **`r n_feedbacks`** |
| Виявлено унікальних ідей/проблем | **`r n_ideas_total`** |
| Технічних багів (категорій) | **`r n_bugs_total`** |
| Загальна кількість згадок багів | **`r total_bug_mentions`** |

: Загальна статистика дослідження {.striped .hover}

---

## Топ-5 найбільших проблем

::: {.callout-important appearance="simple" icon=false}
**Ці п'ять проблем — найчастіше згадувані болі користувачів.** Вони охоплюють якість рідінгів та UX чат-функцій і мають бути пріоритизовані першочергово.
:::

### 1. Неточні передбачення — не збулися {.unnumbered}

::: {.callout-tip appearance="minimal" icon=false}
**Код:** `2.2.a` · **Згадок: 24**
:::

Прогнози та передбачення не збулися — вказані дати та події не відбулися. Це — **найболючіша проблема** для high-value користувачів, яка безпосередньо підриває довіру до платформи.

> *"None of the predictions worked out. I was always waiting for something to happen and when it didn't, some story was made."*

---

### 2. Повільні відповіді радників (3–5+ хв) {.unnumbered}

::: {.callout-tip appearance="minimal" icon=false}
**Код:** `2.1.a` · **Згадок: 23**
:::

Експерти відповідають занадто повільно — 3–5+ хвилин між повідомленнями. Користувачі відчувають, що їхні кредити горять на очікуванні, а не на фактичну консультацію.

> *"Some of them take more than 3–4 mins to reply. Sometimes advisors don't give direct answers and try to extend the time as much as possible."*

---

### 3. Нечіткі / загальні / розмиті відповіді {.unnumbered}

::: {.callout-tip appearance="minimal" icon=false}
**Код:** `2.2.c` · **Згадок: 21**
:::

Відповіді занадто загальні, нечіткі або "загадкові" — не дають конкретної корисної інформації. Користувачі відчувають, що отримують шаблонні фрази замість персоналізованого рідінгу.

> *"Very vague statement over and over. Not detailed."*

---

### 4. Copy-paste функціональність {.unnumbered}

::: {.callout-tip appearance="minimal" icon=false}
**Код:** `1.2.a` · **Згадок: 13**
:::

Неможливо копіювати та вставляти текст у чаті — ні з інших додатків, ні всередині платформи. Особливо критично для користувачів з дислексією та іншими обмеженнями.

> *"I got dyslexia and sometimes I write a message on my phone and want to copy and paste it and you're not allowed to. I have to rewrite the message."*

---

### 5. Непорозумілість у питаннях користувача / off-topic {.unnumbered}

::: {.callout-tip appearance="minimal" icon=false}
**Код:** `2.1.c` · **Згадок: 10**
:::

Експерт не розуміє суті питання, яке було закладено користувачем, через неправильний виклад думок чи перенавантаження запитом. Через що, витрачаються кредити заради уточнення.

> *"Readers don't read my intentionally clarified needs and my questions clearly at all and keep giving wrong and unreliable answers."*

---

### Візуалізація топ-5 {.unnumbered}

```{r}
#| label: fig-top5
#| fig-cap: "Топ-5 проблем за кількістю згадувань"
#| fig-height: 4.5
#| fig-width: 8

top5_plot <- top5 |>
  mutate(idea = str_wrap(idea, width = 35)) |>
  mutate(idea = fct_reorder(idea, number_of_mentions))

ggplot(top5_plot, aes(x = number_of_mentions, y = idea, fill = number_of_mentions)) +
  geom_col(show.legend = FALSE) +
  geom_text(aes(label = number_of_mentions), hjust = -0.3, fontface = "bold", size = 4) +
  scale_fill_gradient(low = "#5DADE2", high = "#1B3A5C") +
  scale_x_continuous(expand = expansion(mult = c(0, 0.15))) +
  labs(x = "Кількість згадок", y = NULL) +
  theme_minimal(base_size = 13) +
  theme(
    panel.grid.major.y = element_blank(),
    panel.grid.minor = element_blank(),
    plot.title = element_text(face = "bold")
  )
```

---

## Баг-репорт

::: {.callout-warning appearance="simple" icon=false}
**Усі виявлені технічні баги.** Впорядковані за кількістю згадок — від найкритичніших до найменш поширених.
:::

```{r}
#| label: tbl-bugs
#| tbl-cap: "Перелік технічних багів за кількістю згадок"

bugs_tbl <- bugs |>
  arrange(desc(number_of_mentions)) |>
  select(
    `Код` = code,
    `Баг` = idea,
    `Згадок` = number_of_mentions,
    `Опис` = description
  )

if (is_html) {
  bugs_tbl |>
    kable(align = c("c", "l", "c", "l")) |>
    kable_styling(
      bootstrap_options = c("striped", "hover", "condensed"),
      full_width = TRUE
    ) |>
    column_spec(3, bold = TRUE, color = "#C0392B")
} else {
  bugs_tbl |>
    kable(align = c("c", "l", "c", "l"))
}
```

```{r}
#| label: fig-bugs
#| fig-cap: "Технічні баги за кількістю згадок"
#| fig-height: 5
#| fig-width: 8

bugs_plot <- bugs |>
  mutate(idea = str_wrap(idea, width = 30)) |>
  mutate(idea = fct_reorder(idea, number_of_mentions))

ggplot(bugs_plot, aes(x = number_of_mentions, y = idea, fill = number_of_mentions)) +
  geom_col(show.legend = FALSE) +
  geom_text(aes(label = number_of_mentions), hjust = -0.3, fontface = "bold", size = 3.5) +
  scale_fill_gradient(low = "#F5B041", high = "#C0392B") +
  scale_x_continuous(expand = expansion(mult = c(0, 0.15))) +
  labs(x = "Кількість згадок", y = NULL) +
  theme_minimal(base_size = 12) +
  theme(
    panel.grid.major.y = element_blank(),
    panel.grid.minor = element_blank()
  )
```

::: {.callout-note collapse="true"}
## Цитати користувачів по кожному багу

```{r}
#| label: bug-quotes
#| results: asis

bugs |>
  arrange(desc(number_of_mentions)) |>
  pwalk(function(code, idea, number_of_mentions, description, best_quote) {
    cat(glue::glue("\n**{code} — {idea}** ({number_of_mentions} згадок)\n\n"))
    cat(glue::glue("> *\"{best_quote}\"*\n\n"))
  })
```
:::

---

## Повна картина: розподіл усіх ідей

```{r}
#| label: fig-all-ideas
#| fig-cap: "Усі ідеї/проблеми, впорядковані за кількістю згадок"
#| fig-height: 14
#| fig-width: 9

category_colors <- c(
  "1. Product / Engineering"       = "#2E86C1",
  "2. Supply / Advisor Operations"  = "#E67E22",
  "3. Monetization / Business"      = "#27AE60",
  "4. Trust & Safety"               = "#8E44AD"
)

all_plot <- ideas |>
  mutate(
    idea_label = str_wrap(paste0(code, " — ", idea), width = 45),
    idea_label = fct_reorder(idea_label, number_of_mentions),
    category = case_when(
      str_starts(code, "1") ~ "1. Product / Engineering",
      str_starts(code, "2") ~ "2. Supply / Advisor Operations",
      str_starts(code, "3") ~ "3. Monetization / Business",
      str_starts(code, "4") ~ "4. Trust & Safety",
      TRUE ~ "Інше"
    )
  )

ggplot(all_plot, aes(x = number_of_mentions, y = idea_label, fill = category)) +
  geom_col() +
  geom_text(aes(label = number_of_mentions), hjust = -0.2, size = 3) +
  scale_x_continuous(expand = expansion(mult = c(0, 0.12))) +
  scale_fill_manual(values = category_colors, name = "Категорія") +
  labs(x = "Кількість згадок", y = NULL) +
  theme_minimal(base_size = 11) +
  theme(
    panel.grid.major.y = element_blank(),
    panel.grid.minor = element_blank(),
    legend.position = "top",
    legend.title = element_text(face = "bold")
  )
```

---

## Методологія

::: {.callout-note appearance="simple" icon=false}
**Як проводився аналіз**
:::

### Дані {.unnumbered}

Вхідні дані складалися з трьох джерел:

- **Raw feedback** (`Raw feedback - Feedbacks.csv`) — сирі цитати користувачів із датою, джерелом та `user_id`.
- **User status** (`user_status.csv`) — статус кожного користувача: `active`, `dormant` або `churned`.
- **Idea Dictionary** (`Idea_Dictionary.xlsx`) — словник кодів: опис кожної підкатегорії та найкраща цитата.

### Процес {.unnumbered}

1. **Збір фідбеку:** Зібрано цитати від high-value користувачів з різних каналів (тікети підтримки та інші джерела).

2. **Категоризація:** Кожен фідбек класифіковано за системою кодів (варіант B з [попереднього звіту](Feedback_Categorization_Options.html)), результат збережено у `Feedback_Classified.xlsx`. Система кодів:
   - `1.x` — Продуктові питання (баги `1.1`, фічі `1.2`, кредитна система `1.3`)
   - `2.x` — Якість радників (швидкість `2.1`, точність `2.2`, професійність `2.3`, AI-підозри `2.4`)
   - `3.x` — Ціноутворення та оплата
   - `4.x` — Приватність та безпека

3. **Об'єднання з легендою:** Класифіковані фідбеки об'єднано з `user_status` та `Idea_Dictionary` через `left_join`. Категорія `5` (позитивні відгуки) відфільтрована.

4. **Підрахунок згадок:** Згруповано по `code` та підраховано кількість згадок. Один фідбек міг містити кілька проблем і відповідно кодувався кількома кодами.

5. **Ідентифікація топ-5:** Відібрано п'ять підкатегорій із найбільшою кількістю згадувань, **виключивши баги** (коди `1.1.x`).

6. **Баг-репорт:** Окремо виділено всі підкатегорії з кодом `1.1.x` (технічні баги) у баг-репорт.

### Інструменти {.unnumbered}

- **R** + `tidyverse` — обробка та аналіз даних
- **Quarto** — генерація звіту

---

## Висновки {.unnumbered}

::: {.callout-important}
## Ключові висновки

**3 з 5 топ-проблем стосуються якості радників** (неточні прогнози, повільні відповіді, розмиті відповіді), а не технічних багів. Це свідчить про те, що для high-value користувачів якість сервісу є більш болючою, ніж технічна стабільність.

**Copy-paste** — єдина продуктова фіча у топ-5, але з 13 згадками вона критична з точки зору accessibility.

**Баги** сумарно набрали **`r total_bug_mentions` згадок** по `r n_bugs_total` категоріях, де найбільше скарг на баги черги (`1.1.c`, 13 згадок) та списання кредитів без підключення (`1.1.h`, 13 згадок).
:::
